<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}åœ¨åº«ç®¡ç†{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header class="navbar">
    <div class="left">
      <span class="brand">åœ¨åº«ç®¡ç†</span>
      <a class="navbtn" href="{{ url_for('inventory.dashboard') }}">ğŸ“¦ åœ¨åº«ä¸€è¦§</a>
    </div>

    <!-- PCãƒŠãƒ“ -->
    <div class="right nav-desktop">
      {% if current_user.is_authenticated %}
        <span class="hello">ğŸ‘¤ {{ current_user.username }}</span>
        <a class="navlink" href="{{ url_for('inventory.products') }}">ğŸ§¾ å•†å“</a>
        <a class="navlink" href="{{ url_for('inventory.movements') }}">ğŸ” å…¥å‡ºåº«</a>
        <a class="navlink" href="{{ url_for('auth.change_password') }}">ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</a>
        {% if current_user.is_admin %}
          <a class="navlink" href="{{ url_for('inventory.admin_users') }}">ğŸ‘¥ ã‚¹ã‚¿ãƒƒãƒ•</a>
        {% endif %}
        <a class="navlink" href="{{ url_for('auth.logout') }}">ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
      {% else %}
        <a class="navlink" href="{{ url_for('auth.login') }}">ãƒ­ã‚°ã‚¤ãƒ³</a>
      {% endif %}
    </div>

    <!-- ãƒ¢ãƒã‚¤ãƒ«ï¼šãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ -->
    <button class="hamburger" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼" onclick="toggleMenu()">â˜°</button>
  </header>

  <!-- ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <nav id="mobileMenu" class="mobile-menu">
    {% if current_user.is_authenticated %}
      <div class="mob-item">ğŸ‘¤ {{ current_user.username }}</div>
      <a class="mob-link" href="{{ url_for('inventory.dashboard') }}">ğŸ“¦ åœ¨åº«ä¸€è¦§</a>
      <a class="mob-link" href="{{ url_for('inventory.products') }}">ğŸ§¾ å•†å“</a>
      <a class="mob-link" href="{{ url_for('inventory.movements') }}">ğŸ” å…¥å‡ºåº«</a>
      <a class="mob-link" href="{{ url_for('auth.change_password') }}">ğŸ”‘ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´</a>
      {% if current_user.is_admin %}
        <a class="mob-link" href="{{ url_for('inventory.admin_users') }}">ğŸ‘¥ ã‚¹ã‚¿ãƒƒãƒ•</a>
      {% endif %}
      <a class="mob-link" href="{{ url_for('auth.logout') }}">ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
    {% else %}
      <a class="mob-link" href="{{ url_for('auth.login') }}">ãƒ­ã‚°ã‚¤ãƒ³</a>
    {% endif %}
  </nav>

  <main class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="flashes">
          {% for category, message in messages %}
            <li class="flash {{ category }}">{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <script>
    function toggleMenu() {
      const el = document.getElementById('mobileMenu');
      if (!el) return;
      el.classList.toggle('open');
    }
    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    document.addEventListener('click', function(ev){
      const menu = document.getElementById('mobileMenu');
      const btn = document.querySelector('.hamburger');
      if (!menu || !btn) return;
      if (!menu.contains(ev.target) && !btn.contains(ev.target)) {
        menu.classList.remove('open');
      }
    });
  </script>
</body>
</html>
