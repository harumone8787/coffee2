{% extends 'base.html' %}
{% block title %}å•†å“ - åœ¨åº«ç®¡ç†{% endblock %}
{% block content %}
<h1>å•†å“</h1>

{% if current_user.is_admin %}
<form method="post" class="grid-form">
  <div>
    <label>å•†å“å</label>
    <input name="name" required>
  </div>
  <div>
    <label>å˜ä½ï¼ˆä¾‹ï¼šå€‹ï¼æœ¬ï¼è¢‹ï¼‰</label>
    <input name="unit" required>
  </div>
  <div>
    <label>æœ€ä½åœ¨åº«æ•°</label>
    <input type="number" name="min_stock" value="0" min="0" required>
  </div>
  <div>
    <label>ä»•å…¥ã‚Œå…ˆ</label>
    <input name="supplier">
  </div>
  <div class="full">
    <button type="submit" class="button-accent">âœ… ç™»éŒ²ã™ã‚‹</button>
  </div>
</form>
{% else %}
<div class="form">ã‚¹ã‚¿ãƒƒãƒ•ã¯å•†å“ç™»éŒ²ãƒ»ç·¨é›†ã§ãã¾ã›ã‚“ï¼ˆé–²è¦§ã®ã¿ï¼‰ã€‚</div>
{% endif %}

<h2 class="mt-3">ç™»éŒ²æ¸ˆã¿å•†å“</h2>
<div class="table-responsive">
  <table class="table" id="products-table">
    <thead>
      <tr>
        <th>å•†å“å</th>
        <th>åœ¨åº«</th>
        <th>å˜ä½</th>
        <th>æœ€ä½åœ¨åº«æ•°</th>
        <th>ä»•å…¥ã‚Œå…ˆ</th>
        <th>ç™»éŒ²æ—¥</th>
        {% if current_user.is_admin %}<th>æ“ä½œ</th>{% endif %}
      </tr>
    </thead>
    <tbody>
      {% for p in products %}
      <tr id="row-{{ p.id }}">
        <td>{{ p.name }}</td>
        <td>{{ p.current_stock }}</td>
        <td>{{ p.unit }}</td>
        <td>{{ p.min_stock }}</td>
        <td>{{ p.supplier or '-' }}</td>
        <td>{{ p.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
        {% if current_user.is_admin %}
        <td>
          <a class="button-accent" href="{{ url_for('inventory.product_edit', pid=p.id) }}">âœï¸ ç·¨é›†</a>
          <form method="post" action="{{ url_for('inventory.product_delete', pid=p.id) }}" style="display:inline" onsubmit="return confirm('ã“ã®å•†å“ã‚’éè¡¨ç¤ºã«ã—ã¾ã™ã€‚å±¥æ­´ã¯æ®‹ã‚Šã¾ã™ã€‚ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ');">
            <button type="submit" class="button-danger">ğŸ—‘ï¸ å‰Šé™¤</button>
          </form>
        </td>
        {% endif %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
